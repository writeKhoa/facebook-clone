const session = await mongoose.startSession();
session.startTransaction();

try {
  // Find the post by its ID and increment the like count
  const postId = '123'; // replace with actual post ID
  const post = await Post.findByIdAndUpdate(postId, { $inc: { likesCount: 1 } }, { new: true, session });

  // Create a new like object and add it to the likes array in the post
  const like = new Like({ postId });
  post.likes.push(like);

  // Save the changes to the post and the new like object in a single transaction
  await Promise.all([post.save({ session }), like.save({ session })]);

  await session.commitTransaction();
  session.endSession();
} catch (error) {
  await session.abortTransaction();
  session.endSession();
  console.error(error);
}